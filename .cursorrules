# Project: Etna

## Soul Doc
- Project values and priorities: [docs/soul-doc.md](docs/soul-doc.md); Cursor rule: [.cursor/rules/soul-doc.mdc](.cursor/rules/soul-doc.mdc).

## Enterprise (rules, skills, workers, hooks)
- Baseline (always): [.cursor/rules/enterprise-baseline.mdc](.cursor/rules/enterprise-baseline.mdc). API: [.cursor/rules/api-first.mdc](.cursor/rules/api-first.mdc). Frontend: [.cursor/rules/frontend.mdc](.cursor/rules/frontend.mdc). Lib: [.cursor/rules/lib-conventions.mdc](.cursor/rules/lib-conventions.mdc).
- Skills: api-route, auth-check, db-migration, error-handling, testing, security-review, observability, openapi-snippet, dependency-upgrade ([.cursor/skills/](.cursor/skills/)).
- Workers/hooks: [.cursor/WORKERS_ENTERPRISE.md](.cursor/WORKERS_ENTERPRISE.md), [.cursor/HOOKS_ENTERPRISE.md](.cursor/HOOKS_ENTERPRISE.md). Script: `./scripts/check-enterprise.sh`. **To see all worker roles:** [AGENTS.md](AGENTS.md) (Cursor may not show a Workers list in the UI—prompt by name or open AGENTS.md).

## UX, usability & accessibility
- When editing UI (components, pages, forms): [.cursor/rules/ux-usability-accessibility.mdc](.cursor/rules/ux-usability-accessibility.mdc). Skills: [.cursor/skills/ux-review](.cursor/skills/ux-review), [.cursor/skills/usability-check](.cursor/skills/usability-check), [.cursor/skills/accessibility](.cursor/skills/accessibility). Workers/hooks: [.cursor/WORKERS_UX.md](.cursor/WORKERS_UX.md), [.cursor/HOOKS_UX.md](.cursor/HOOKS_UX.md).

## Agent instructions
- Be explicit to avoid confusion: [.cursor/rules/agent-explicit-instructions.mdc](.cursor/rules/agent-explicit-instructions.mdc). Call out what is implemented vs placeholder; don’t imply “everything is done” when some UI has no backend/flow.

## Stack
- Next.js (App Router), TypeScript, Prisma, React, Shadcn UI
- Use existing UI components from components/ui/; add via Shadcn MCP (.cursor/mcp.json)

## Code standards
- TypeScript strict: prefer explicit types for API boundaries and shared types; avoid `any`
- Prefer async/await; handle errors with try/catch and log or rethrow with context
- API routes: validate input (e.g. lib/validation), return consistent JSON and status codes
- Prefer server components by default; use "use client" only when needed (state, hooks, browser APIs)

## Structure
- app/: routes and pages; api/: route handlers
- lib/: shared logic, DB, auth, integrations
- components/: reusable UI; colocate component-specific logic
- prisma/: schema and migrations only

## Security & data
- Never log or expose secrets or PII; use env vars for config
- Use Prisma for all DB access; parameterized queries only
- Auth: use existing auth.ts and session helpers

## Testing & quality
- Add/update tests for new or changed lib/ and API behavior
- Run lint (npm run lint) and fix before committing
